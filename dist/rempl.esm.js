const{connectPublisherWs:Xe,createEnv:Ze,createPublisher:Je,createSandbox:Qe,getEnv:Ke,getHost:$e,getSelfSubscriber:tn,getSubscriber:en,scriptFromFile:nn,version:rn}=function At(){var Qt=Object.create,dt=Object.defineProperty,Kt=Object.defineProperties,$t=Object.getOwnPropertyDescriptor,te=Object.getOwnPropertyDescriptors,ee=Object.getOwnPropertyNames,Et=Object.getOwnPropertySymbols,ne=Object.getPrototypeOf,St=Object.prototype.hasOwnProperty,re=Object.prototype.propertyIsEnumerable,Bt=(t,i,n)=>i in t?dt(t,i,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[i]=n,ft=(t,i)=>{for(var n in i||(i={}))St.call(i,n)&&Bt(t,n,i[n]);if(Et)for(var n of Et(i))re.call(i,n)&&Bt(t,n,i[n]);return t},oe=(t,i)=>Kt(t,te(i)),ie=(t,i)=>()=>(i||t((i={exports:{}}).exports,i),i.exports),se=(t,i,n,s)=>{if(i&&typeof i=="object"||typeof i=="function")for(let o of ee(i))!St.call(t,o)&&o!==n&&dt(t,o,{get:()=>i[o],enumerable:!(s=$t(i,o))||s.enumerable});return t},ae=(t,i,n)=>(n=t!=null?Qt(ne(t)):{},se(i||!t||!t.__esModule?dt(n,"default",{value:t,enumerable:!0}):n,t)),ce=ie((t,i)=>{(function(n,s){typeof t=="object"&&typeof i=="object"?i.exports=s():typeof define=="function"&&define.amd?define([],s):typeof t=="object"?t.io=s():n.io=s()})(t,function(){return function(n){function s(e){if(o[e])return o[e].exports;var l=o[e]={exports:{},id:e,loaded:!1};return n[e].call(l.exports,l,l.exports,s),l.loaded=!0,l.exports}var o={};return s.m=n,s.c=o,s.p="",s(0)}([function(n,s,o){"use strict";function e(g,f){(typeof g>"u"?"undefined":l(g))==="object"&&(f=g,g=void 0),f=f||{};var c,h=p(g),a=h.source,r=h.id,u=h.path,v=b[r]&&u in b[r].nsps,m=f.forceNew||f["force new connection"]||f.multiplex===!1||v;return m?c=y(a,f):(b[r]||(b[r]=y(a,f)),c=b[r]),h.query&&!f.query&&(f.query=h.query),c.socket(h.path,f)}var l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},p=o(1),d=o(4),y=o(9);o(3)("socket.io-client"),n.exports=s=e;var b=s.managers={};s.protocol=d.protocol,s.connect=e,s.Manager=o(9),s.Socket=o(34)},function(n,s,o){"use strict";function e(p,d){var y=p;d=d||typeof location<"u"&&location,p==null&&(p=d.protocol+"//"+d.host),typeof p=="string"&&(p.charAt(0)==="/"&&(p=p.charAt(1)==="/"?d.protocol+p:d.host+p),/^(https?|wss?):\/\//.test(p)||(p=typeof d<"u"?d.protocol+"//"+p:"https://"+p),y=l(p)),y.port||(/^(http|ws)$/.test(y.protocol)?y.port="80":/^(http|ws)s$/.test(y.protocol)&&(y.port="443")),y.path=y.path||"/";var b=y.host.indexOf(":")!==-1,g=b?"["+y.host+"]":y.host;return y.id=y.protocol+"://"+g+":"+y.port,y.href=y.protocol+"://"+g+(d&&d.port===y.port?"":":"+y.port),y}var l=o(2);o(3)("socket.io-client:url"),n.exports=e},function(n,s){function o(d,y){var b=/\/{2,9}/g,g=y.replace(b,"/").split("/");return y.substr(0,1)!="/"&&y.length!==0||g.splice(0,1),y.substr(y.length-1,1)=="/"&&g.splice(g.length-1,1),g}function e(d,y){var b={};return y.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(g,f,c){f&&(b[f]=c)}),b}var l=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,p=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];n.exports=function(d){var y=d,b=d.indexOf("["),g=d.indexOf("]");b!=-1&&g!=-1&&(d=d.substring(0,b)+d.substring(b,g).replace(/:/g,";")+d.substring(g,d.length));for(var f=l.exec(d||""),c={},h=14;h--;)c[p[h]]=f[h]||"";return b!=-1&&g!=-1&&(c.source=y,c.host=c.host.substring(1,c.host.length-1).replace(/;/g,":"),c.authority=c.authority.replace("[","").replace("]","").replace(/;/g,":"),c.ipv6uri=!0),c.pathNames=o(c,c.path),c.queryKey=e(c,c.query),c}},function(n,s){"use strict";n.exports=function(){return function(){}}},function(n,s,o){function e(){}function l(m){var k=""+m.type;if(s.BINARY_EVENT!==m.type&&s.BINARY_ACK!==m.type||(k+=m.attachments+"-"),m.nsp&&m.nsp!=="/"&&(k+=m.nsp+","),m.id!=null&&(k+=m.id),m.data!=null){var x=p(m.data);if(x===!1)return v;k+=x}return k}function p(m){try{return JSON.stringify(m)}catch{return!1}}function d(m,k){function x(E){var C=a.deconstructPacket(E),w=l(C.packet),A=C.buffers;A.unshift(w),k(A)}a.removeBlobs(m,x)}function y(){this.reconstructor=null}function b(m){var k=0,x={type:Number(m.charAt(0))};if(s.types[x.type]==null)return c("unknown packet type "+x.type);if(s.BINARY_EVENT===x.type||s.BINARY_ACK===x.type){for(var E="";m.charAt(++k)!=="-"&&(E+=m.charAt(k),k!=m.length););if(E!=Number(E)||m.charAt(k)!=="-")throw new Error("Illegal attachments");x.attachments=Number(E)}if(m.charAt(k+1)==="/")for(x.nsp="";++k;){var C=m.charAt(k);if(C===","||(x.nsp+=C,k===m.length))break}else x.nsp="/";var w=m.charAt(k+1);if(w!==""&&Number(w)==w){for(x.id="";++k;){var C=m.charAt(k);if(C==null||Number(C)!=C){--k;break}if(x.id+=m.charAt(k),k===m.length)break}x.id=Number(x.id)}if(m.charAt(++k)){var A=g(m.substr(k)),S=A!==!1&&(x.type===s.ERROR||r(A));if(!S)return c("invalid payload");x.data=A}return x}function g(m){try{return JSON.parse(m)}catch{return!1}}function f(m){this.reconPack=m,this.buffers=[]}function c(m){return{type:s.ERROR,data:"parser error: "+m}}var h=(o(3)("socket.io-parser"),o(5)),a=o(6),r=o(7),u=o(8);s.protocol=4,s.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],s.CONNECT=0,s.DISCONNECT=1,s.EVENT=2,s.ACK=3,s.ERROR=4,s.BINARY_EVENT=5,s.BINARY_ACK=6,s.Encoder=e,s.Decoder=y;var v=s.ERROR+'"encode error"';e.prototype.encode=function(m,k){if(s.BINARY_EVENT===m.type||s.BINARY_ACK===m.type)d(m,k);else{var x=l(m);k([x])}},h(y.prototype),y.prototype.add=function(m){var k;if(typeof m=="string")k=b(m),s.BINARY_EVENT===k.type||s.BINARY_ACK===k.type?(this.reconstructor=new f(k),this.reconstructor.reconPack.attachments===0&&this.emit("decoded",k)):this.emit("decoded",k);else{if(!u(m)&&!m.base64)throw new Error("Unknown type: "+m);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");k=this.reconstructor.takeBinaryData(m),k&&(this.reconstructor=null,this.emit("decoded",k))}},y.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},f.prototype.takeBinaryData=function(m){if(this.buffers.push(m),this.buffers.length===this.reconPack.attachments){var k=a.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),k}return null},f.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(n,s,o){function e(p){if(p)return l(p)}function l(p){for(var d in e.prototype)p[d]=e.prototype[d];return p}n.exports=e,e.prototype.on=e.prototype.addEventListener=function(p,d){return this._callbacks=this._callbacks||{},(this._callbacks["$"+p]=this._callbacks["$"+p]||[]).push(d),this},e.prototype.once=function(p,d){function y(){this.off(p,y),d.apply(this,arguments)}return y.fn=d,this.on(p,y),this},e.prototype.off=e.prototype.removeListener=e.prototype.removeAllListeners=e.prototype.removeEventListener=function(p,d){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var y=this._callbacks["$"+p];if(!y)return this;if(arguments.length==1)return delete this._callbacks["$"+p],this;for(var b,g=0;g<y.length;g++)if(b=y[g],b===d||b.fn===d){y.splice(g,1);break}return y.length===0&&delete this._callbacks["$"+p],this},e.prototype.emit=function(p){this._callbacks=this._callbacks||{};for(var d=new Array(arguments.length-1),y=this._callbacks["$"+p],b=1;b<arguments.length;b++)d[b-1]=arguments[b];if(y){y=y.slice(0);for(var b=0,g=y.length;b<g;++b)y[b].apply(this,d)}return this},e.prototype.listeners=function(p){return this._callbacks=this._callbacks||{},this._callbacks["$"+p]||[]},e.prototype.hasListeners=function(p){return!!this.listeners(p).length}},function(n,s,o){function e(f,c){if(!f)return f;if(d(f)){var h={_placeholder:!0,num:c.length};return c.push(f),h}if(p(f)){for(var a=new Array(f.length),r=0;r<f.length;r++)a[r]=e(f[r],c);return a}if(typeof f=="object"&&!(f instanceof Date)){var a={};for(var u in f)a[u]=e(f[u],c);return a}return f}function l(f,c){if(!f)return f;if(f&&f._placeholder)return c[f.num];if(p(f))for(var h=0;h<f.length;h++)f[h]=l(f[h],c);else if(typeof f=="object")for(var a in f)f[a]=l(f[a],c);return f}var p=o(7),d=o(8),y=Object.prototype.toString,b=typeof Blob=="function"||typeof Blob<"u"&&y.call(Blob)==="[object BlobConstructor]",g=typeof File=="function"||typeof File<"u"&&y.call(File)==="[object FileConstructor]";s.deconstructPacket=function(f){var c=[],h=f.data,a=f;return a.data=e(h,c),a.attachments=c.length,{packet:a,buffers:c}},s.reconstructPacket=function(f,c){return f.data=l(f.data,c),f.attachments=void 0,f},s.removeBlobs=function(f,c){function h(u,v,m){if(!u)return u;if(b&&u instanceof Blob||g&&u instanceof File){a++;var k=new FileReader;k.onload=function(){m?m[v]=this.result:r=this.result,--a||c(r)},k.readAsArrayBuffer(u)}else if(p(u))for(var x=0;x<u.length;x++)h(u[x],x,u);else if(typeof u=="object"&&!d(u))for(var E in u)h(u[E],E,u)}var a=0,r=f;h(r),a||c(r)}},function(n,s){var o={}.toString;n.exports=Array.isArray||function(e){return o.call(e)=="[object Array]"}},function(n,s){function o(d){return e&&Buffer.isBuffer(d)||l&&(d instanceof ArrayBuffer||p(d))}n.exports=o;var e=typeof Buffer=="function"&&typeof Buffer.isBuffer=="function",l=typeof ArrayBuffer=="function",p=function(d){return typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(d):d.buffer instanceof ArrayBuffer}},function(n,s,o){"use strict";function e(r,u){if(!(this instanceof e))return new e(r,u);r&&(typeof r>"u"?"undefined":l(r))==="object"&&(u=r,r=void 0),u=u||{},u.path=u.path||"/socket.io",this.nsps={},this.subs=[],this.opts=u,this.reconnection(u.reconnection!==!1),this.reconnectionAttempts(u.reconnectionAttempts||1/0),this.reconnectionDelay(u.reconnectionDelay||1e3),this.reconnectionDelayMax(u.reconnectionDelayMax||5e3),this.randomizationFactor(u.randomizationFactor||.5),this.backoff=new h({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(u.timeout==null?2e4:u.timeout),this.readyState="closed",this.uri=r,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var v=u.parser||b;this.encoder=new v.Encoder,this.decoder=new v.Decoder,this.autoConnect=u.autoConnect!==!1,this.autoConnect&&this.open()}var l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},p=o(10),d=o(34),y=o(5),b=o(4),g=o(36),f=o(37),c=(o(3)("socket.io-client:manager"),o(33)),h=o(38),a=Object.prototype.hasOwnProperty;n.exports=e,e.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var r in this.nsps)a.call(this.nsps,r)&&this.nsps[r].emit.apply(this.nsps[r],arguments)},e.prototype.updateSocketIds=function(){for(var r in this.nsps)a.call(this.nsps,r)&&(this.nsps[r].id=this.generateId(r))},e.prototype.generateId=function(r){return(r==="/"?"":r+"#")+this.engine.id},y(e.prototype),e.prototype.reconnection=function(r){return arguments.length?(this._reconnection=!!r,this):this._reconnection},e.prototype.reconnectionAttempts=function(r){return arguments.length?(this._reconnectionAttempts=r,this):this._reconnectionAttempts},e.prototype.reconnectionDelay=function(r){return arguments.length?(this._reconnectionDelay=r,this.backoff&&this.backoff.setMin(r),this):this._reconnectionDelay},e.prototype.randomizationFactor=function(r){return arguments.length?(this._randomizationFactor=r,this.backoff&&this.backoff.setJitter(r),this):this._randomizationFactor},e.prototype.reconnectionDelayMax=function(r){return arguments.length?(this._reconnectionDelayMax=r,this.backoff&&this.backoff.setMax(r),this):this._reconnectionDelayMax},e.prototype.timeout=function(r){return arguments.length?(this._timeout=r,this):this._timeout},e.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()},e.prototype.open=e.prototype.connect=function(r,u){if(~this.readyState.indexOf("open"))return this;this.engine=p(this.uri,this.opts);var v=this.engine,m=this;this.readyState="opening",this.skipReconnect=!1;var k=g(v,"open",function(){m.onopen(),r&&r()}),x=g(v,"error",function(w){if(m.cleanup(),m.readyState="closed",m.emitAll("connect_error",w),r){var A=new Error("Connection error");A.data=w,r(A)}else m.maybeReconnectOnOpen()});if(this._timeout!==!1){var E=this._timeout;E===0&&k.destroy();var C=setTimeout(function(){k.destroy(),v.close(),v.emit("error","timeout"),m.emitAll("connect_timeout",E)},E);this.subs.push({destroy:function(){clearTimeout(C)}})}return this.subs.push(k),this.subs.push(x),this},e.prototype.onopen=function(){this.cleanup(),this.readyState="open",this.emit("open");var r=this.engine;this.subs.push(g(r,"data",f(this,"ondata"))),this.subs.push(g(r,"ping",f(this,"onping"))),this.subs.push(g(r,"pong",f(this,"onpong"))),this.subs.push(g(r,"error",f(this,"onerror"))),this.subs.push(g(r,"close",f(this,"onclose"))),this.subs.push(g(this.decoder,"decoded",f(this,"ondecoded")))},e.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},e.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},e.prototype.ondata=function(r){this.decoder.add(r)},e.prototype.ondecoded=function(r){this.emit("packet",r)},e.prototype.onerror=function(r){this.emitAll("error",r)},e.prototype.socket=function(r,u){function v(){~c(k.connecting,m)||k.connecting.push(m)}var m=this.nsps[r];if(!m){m=new d(this,r,u),this.nsps[r]=m;var k=this;m.on("connecting",v),m.on("connect",function(){m.id=k.generateId(r)}),this.autoConnect&&v()}return m},e.prototype.destroy=function(r){var u=c(this.connecting,r);~u&&this.connecting.splice(u,1),this.connecting.length||this.close()},e.prototype.packet=function(r){var u=this;r.query&&r.type===0&&(r.nsp+="?"+r.query),u.encoding?u.packetBuffer.push(r):(u.encoding=!0,this.encoder.encode(r,function(v){for(var m=0;m<v.length;m++)u.engine.write(v[m],r.options);u.encoding=!1,u.processPacketQueue()}))},e.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var r=this.packetBuffer.shift();this.packet(r)}},e.prototype.cleanup=function(){for(var r=this.subs.length,u=0;u<r;u++){var v=this.subs.shift();v.destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},e.prototype.close=e.prototype.disconnect=function(){this.skipReconnect=!0,this.reconnecting=!1,this.readyState==="opening"&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},e.prototype.onclose=function(r){this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",r),this._reconnection&&!this.skipReconnect&&this.reconnect()},e.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var r=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var u=this.backoff.duration();this.reconnecting=!0;var v=setTimeout(function(){r.skipReconnect||(r.emitAll("reconnect_attempt",r.backoff.attempts),r.emitAll("reconnecting",r.backoff.attempts),r.skipReconnect||r.open(function(m){m?(r.reconnecting=!1,r.reconnect(),r.emitAll("reconnect_error",m.data)):r.onreconnect()}))},u);this.subs.push({destroy:function(){clearTimeout(v)}})}},e.prototype.onreconnect=function(){var r=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",r)}},function(n,s,o){n.exports=o(11),n.exports.parser=o(19)},function(n,s,o){function e(c,h){return this instanceof e?(h=h||{},c&&typeof c=="object"&&(h=c,c=null),c?(c=g(c),h.hostname=c.host,h.secure=c.protocol==="https"||c.protocol==="wss",h.port=c.port,c.query&&(h.query=c.query)):h.host&&(h.hostname=g(h.host).host),this.secure=h.secure!=null?h.secure:typeof location<"u"&&location.protocol==="https:",h.hostname&&!h.port&&(h.port=this.secure?"443":"80"),this.agent=h.agent||!1,this.hostname=h.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=h.port||(typeof location<"u"&&location.port?location.port:this.secure?443:80),this.query=h.query||{},typeof this.query=="string"&&(this.query=f.decode(this.query)),this.upgrade=h.upgrade!==!1,this.path=(h.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!h.forceJSONP,this.jsonp=h.jsonp!==!1,this.forceBase64=!!h.forceBase64,this.enablesXDR=!!h.enablesXDR,this.withCredentials=h.withCredentials!==!1,this.timestampParam=h.timestampParam||"t",this.timestampRequests=h.timestampRequests,this.transports=h.transports||["polling","websocket"],this.transportOptions=h.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=h.policyPort||843,this.rememberUpgrade=h.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=h.onlyBinaryUpgrades,this.perMessageDeflate=h.perMessageDeflate!==!1&&(h.perMessageDeflate||{}),this.perMessageDeflate===!0&&(this.perMessageDeflate={}),this.perMessageDeflate&&this.perMessageDeflate.threshold==null&&(this.perMessageDeflate.threshold=1024),this.pfx=h.pfx||null,this.key=h.key||null,this.passphrase=h.passphrase||null,this.cert=h.cert||null,this.ca=h.ca||null,this.ciphers=h.ciphers||null,this.rejectUnauthorized=h.rejectUnauthorized===void 0||h.rejectUnauthorized,this.forceNode=!!h.forceNode,this.isReactNative=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative",(typeof self>"u"||this.isReactNative)&&(h.extraHeaders&&Object.keys(h.extraHeaders).length>0&&(this.extraHeaders=h.extraHeaders),h.localAddress&&(this.localAddress=h.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,void this.open()):new e(c,h)}function l(c){var h={};for(var a in c)c.hasOwnProperty(a)&&(h[a]=c[a]);return h}var p=o(12),d=o(5),y=(o(3)("engine.io-client:socket"),o(33)),b=o(19),g=o(2),f=o(27);n.exports=e,e.priorWebsocketSuccess=!1,d(e.prototype),e.protocol=b.protocol,e.Socket=e,e.Transport=o(18),e.transports=o(12),e.parser=o(19),e.prototype.createTransport=function(c){var h=l(this.query);h.EIO=b.protocol,h.transport=c;var a=this.transportOptions[c]||{};this.id&&(h.sid=this.id);var r=new p[c]({query:h,socket:this,agent:a.agent||this.agent,hostname:a.hostname||this.hostname,port:a.port||this.port,secure:a.secure||this.secure,path:a.path||this.path,forceJSONP:a.forceJSONP||this.forceJSONP,jsonp:a.jsonp||this.jsonp,forceBase64:a.forceBase64||this.forceBase64,enablesXDR:a.enablesXDR||this.enablesXDR,withCredentials:a.withCredentials||this.withCredentials,timestampRequests:a.timestampRequests||this.timestampRequests,timestampParam:a.timestampParam||this.timestampParam,policyPort:a.policyPort||this.policyPort,pfx:a.pfx||this.pfx,key:a.key||this.key,passphrase:a.passphrase||this.passphrase,cert:a.cert||this.cert,ca:a.ca||this.ca,ciphers:a.ciphers||this.ciphers,rejectUnauthorized:a.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:a.perMessageDeflate||this.perMessageDeflate,extraHeaders:a.extraHeaders||this.extraHeaders,forceNode:a.forceNode||this.forceNode,localAddress:a.localAddress||this.localAddress,requestTimeout:a.requestTimeout||this.requestTimeout,protocols:a.protocols||void 0,isReactNative:this.isReactNative});return r},e.prototype.open=function(){var c;if(this.rememberUpgrade&&e.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)c="websocket";else{if(this.transports.length===0){var h=this;return void setTimeout(function(){h.emit("error","No transports available")},0)}c=this.transports[0]}this.readyState="opening";try{c=this.createTransport(c)}catch{return this.transports.shift(),void this.open()}c.open(),this.setTransport(c)},e.prototype.setTransport=function(c){var h=this;this.transport&&this.transport.removeAllListeners(),this.transport=c,c.on("drain",function(){h.onDrain()}).on("packet",function(a){h.onPacket(a)}).on("error",function(a){h.onError(a)}).on("close",function(){h.onClose("transport close")})},e.prototype.probe=function(c){function h(){if(C.onlyBinaryUpgrades){var w=!this.supportsBinary&&C.transport.supportsBinary;E=E||w}E||(x.send([{type:"ping",data:"probe"}]),x.once("packet",function(A){if(!E)if(A.type==="pong"&&A.data==="probe"){if(C.upgrading=!0,C.emit("upgrading",x),!x)return;e.priorWebsocketSuccess=x.name==="websocket",C.transport.pause(function(){E||C.readyState!=="closed"&&(k(),C.setTransport(x),x.send([{type:"upgrade"}]),C.emit("upgrade",x),x=null,C.upgrading=!1,C.flush())})}else{var S=new Error("probe error");S.transport=x.name,C.emit("upgradeError",S)}}))}function a(){E||(E=!0,k(),x.close(),x=null)}function r(w){var A=new Error("probe error: "+w);A.transport=x.name,a(),C.emit("upgradeError",A)}function u(){r("transport closed")}function v(){r("socket closed")}function m(w){x&&w.name!==x.name&&a()}function k(){x.removeListener("open",h),x.removeListener("error",r),x.removeListener("close",u),C.removeListener("close",v),C.removeListener("upgrading",m)}var x=this.createTransport(c,{probe:1}),E=!1,C=this;e.priorWebsocketSuccess=!1,x.once("open",h),x.once("error",r),x.once("close",u),this.once("close",v),this.once("upgrading",m),x.open()},e.prototype.onOpen=function(){if(this.readyState="open",e.priorWebsocketSuccess=this.transport.name==="websocket",this.emit("open"),this.flush(),this.readyState==="open"&&this.upgrade&&this.transport.pause)for(var c=0,h=this.upgrades.length;c<h;c++)this.probe(this.upgrades[c])},e.prototype.onPacket=function(c){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emit("packet",c),this.emit("heartbeat"),c.type){case"open":this.onHandshake(JSON.parse(c.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var h=new Error("server error");h.code=c.data,this.onError(h);break;case"message":this.emit("data",c.data),this.emit("message",c.data)}},e.prototype.onHandshake=function(c){this.emit("handshake",c),this.id=c.sid,this.transport.query.sid=c.sid,this.upgrades=this.filterUpgrades(c.upgrades),this.pingInterval=c.pingInterval,this.pingTimeout=c.pingTimeout,this.onOpen(),this.readyState!=="closed"&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},e.prototype.onHeartbeat=function(c){clearTimeout(this.pingTimeoutTimer);var h=this;h.pingTimeoutTimer=setTimeout(function(){h.readyState!=="closed"&&h.onClose("ping timeout")},c||h.pingInterval+h.pingTimeout)},e.prototype.setPing=function(){var c=this;clearTimeout(c.pingIntervalTimer),c.pingIntervalTimer=setTimeout(function(){c.ping(),c.onHeartbeat(c.pingTimeout)},c.pingInterval)},e.prototype.ping=function(){var c=this;this.sendPacket("ping",function(){c.emit("ping")})},e.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emit("drain"):this.flush()},e.prototype.flush=function(){this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},e.prototype.write=e.prototype.send=function(c,h,a){return this.sendPacket("message",c,h,a),this},e.prototype.sendPacket=function(c,h,a,r){if(typeof h=="function"&&(r=h,h=void 0),typeof a=="function"&&(r=a,a=null),this.readyState!=="closing"&&this.readyState!=="closed"){a=a||{},a.compress=a.compress!==!1;var u={type:c,data:h,options:a};this.emit("packetCreate",u),this.writeBuffer.push(u),r&&this.once("flush",r),this.flush()}},e.prototype.close=function(){function c(){r.onClose("forced close"),r.transport.close()}function h(){r.removeListener("upgrade",h),r.removeListener("upgradeError",h),c()}function a(){r.once("upgrade",h),r.once("upgradeError",h)}if(this.readyState==="opening"||this.readyState==="open"){this.readyState="closing";var r=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?a():c()}):this.upgrading?a():c()}return this},e.prototype.onError=function(c){e.priorWebsocketSuccess=!1,this.emit("error",c),this.onClose("transport error",c)},e.prototype.onClose=function(c,h){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){var a=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",c,h),a.writeBuffer=[],a.prevBufferLen=0}},e.prototype.filterUpgrades=function(c){for(var h=[],a=0,r=c.length;a<r;a++)~y(this.transports,c[a])&&h.push(c[a]);return h}},function(n,s,o){function e(b){var g,f=!1,c=!1,h=b.jsonp!==!1;if(typeof location<"u"){var a=location.protocol==="https:",r=location.port;r||(r=a?443:80),f=b.hostname!==location.hostname||r!==b.port,c=b.secure!==a}if(b.xdomain=f,b.xscheme=c,g=new l(b),"open"in g&&!b.forceJSONP)return new p(b);if(!h)throw new Error("JSONP disabled");return new d(b)}var l=o(13),p=o(16),d=o(30),y=o(31);s.polling=e,s.websocket=y},function(n,s,o){var e=o(14),l=o(15);n.exports=function(p){var d=p.xdomain,y=p.xscheme,b=p.enablesXDR;try{if(typeof XMLHttpRequest<"u"&&(!d||e))return new XMLHttpRequest}catch{}try{if(typeof XDomainRequest<"u"&&!y&&b)return new XDomainRequest}catch{}if(!d)try{return new l[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}},function(n,s){try{n.exports=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{n.exports=!1}},function(n,s){n.exports=function(){return typeof self<"u"?self:typeof window<"u"?window:Function("return this")()}()},function(n,s,o){function e(){}function l(a){if(b.call(this,a),this.requestTimeout=a.requestTimeout,this.extraHeaders=a.extraHeaders,typeof location<"u"){var r=location.protocol==="https:",u=location.port;u||(u=r?443:80),this.xd=typeof location<"u"&&a.hostname!==location.hostname||u!==a.port,this.xs=a.secure!==r}}function p(a){this.method=a.method||"GET",this.uri=a.uri,this.xd=!!a.xd,this.xs=!!a.xs,this.async=a.async!==!1,this.data=a.data!==void 0?a.data:null,this.agent=a.agent,this.isBinary=a.isBinary,this.supportsBinary=a.supportsBinary,this.enablesXDR=a.enablesXDR,this.withCredentials=a.withCredentials,this.requestTimeout=a.requestTimeout,this.pfx=a.pfx,this.key=a.key,this.passphrase=a.passphrase,this.cert=a.cert,this.ca=a.ca,this.ciphers=a.ciphers,this.rejectUnauthorized=a.rejectUnauthorized,this.extraHeaders=a.extraHeaders,this.create()}function d(){for(var a in p.requests)p.requests.hasOwnProperty(a)&&p.requests[a].abort()}var y=o(13),b=o(17),g=o(5),f=o(28),c=(o(3)("engine.io-client:polling-xhr"),o(15));if(n.exports=l,n.exports.Request=p,f(l,b),l.prototype.supportsBinary=!0,l.prototype.request=function(a){return a=a||{},a.uri=this.uri(),a.xd=this.xd,a.xs=this.xs,a.agent=this.agent||!1,a.supportsBinary=this.supportsBinary,a.enablesXDR=this.enablesXDR,a.withCredentials=this.withCredentials,a.pfx=this.pfx,a.key=this.key,a.passphrase=this.passphrase,a.cert=this.cert,a.ca=this.ca,a.ciphers=this.ciphers,a.rejectUnauthorized=this.rejectUnauthorized,a.requestTimeout=this.requestTimeout,a.extraHeaders=this.extraHeaders,new p(a)},l.prototype.doWrite=function(a,r){var u=typeof a!="string"&&a!==void 0,v=this.request({method:"POST",data:a,isBinary:u}),m=this;v.on("success",r),v.on("error",function(k){m.onError("xhr post error",k)}),this.sendXhr=v},l.prototype.doPoll=function(){var a=this.request(),r=this;a.on("data",function(u){r.onData(u)}),a.on("error",function(u){r.onError("xhr poll error",u)}),this.pollXhr=a},g(p.prototype),p.prototype.create=function(){var a={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};a.pfx=this.pfx,a.key=this.key,a.passphrase=this.passphrase,a.cert=this.cert,a.ca=this.ca,a.ciphers=this.ciphers,a.rejectUnauthorized=this.rejectUnauthorized;var r=this.xhr=new y(a),u=this;try{r.open(this.method,this.uri,this.async);try{if(this.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(var v in this.extraHeaders)this.extraHeaders.hasOwnProperty(v)&&r.setRequestHeader(v,this.extraHeaders[v])}}catch{}if(this.method==="POST")try{this.isBinary?r.setRequestHeader("Content-type","application/octet-stream"):r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{r.setRequestHeader("Accept","*/*")}catch{}"withCredentials"in r&&(r.withCredentials=this.withCredentials),this.requestTimeout&&(r.timeout=this.requestTimeout),this.hasXDR()?(r.onload=function(){u.onLoad()},r.onerror=function(){u.onError(r.responseText)}):r.onreadystatechange=function(){if(r.readyState===2)try{var m=r.getResponseHeader("Content-Type");(u.supportsBinary&&m==="application/octet-stream"||m==="application/octet-stream; charset=UTF-8")&&(r.responseType="arraybuffer")}catch{}r.readyState===4&&(r.status===200||r.status===1223?u.onLoad():setTimeout(function(){u.onError(typeof r.status=="number"?r.status:0)},0))},r.send(this.data)}catch(m){return void setTimeout(function(){u.onError(m)},0)}typeof document<"u"&&(this.index=p.requestsCount++,p.requests[this.index]=this)},p.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},p.prototype.onData=function(a){this.emit("data",a),this.onSuccess()},p.prototype.onError=function(a){this.emit("error",a),this.cleanup(!0)},p.prototype.cleanup=function(a){if(typeof this.xhr<"u"&&this.xhr!==null){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=e:this.xhr.onreadystatechange=e,a)try{this.xhr.abort()}catch{}typeof document<"u"&&delete p.requests[this.index],this.xhr=null}},p.prototype.onLoad=function(){var a;try{var r;try{r=this.xhr.getResponseHeader("Content-Type")}catch{}a=r==="application/octet-stream"||r==="application/octet-stream; charset=UTF-8"?this.xhr.response||this.xhr.responseText:this.xhr.responseText}catch(u){this.onError(u)}a!=null&&this.onData(a)},p.prototype.hasXDR=function(){return typeof XDomainRequest<"u"&&!this.xs&&this.enablesXDR},p.prototype.abort=function(){this.cleanup()},p.requestsCount=0,p.requests={},typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",d);else if(typeof addEventListener=="function"){var h="onpagehide"in c?"pagehide":"unload";addEventListener(h,d,!1)}}},function(n,s,o){function e(f){var c=f&&f.forceBase64;g&&!c||(this.supportsBinary=!1),l.call(this,f)}var l=o(18),p=o(27),d=o(19),y=o(28),b=o(29);o(3)("engine.io-client:polling"),n.exports=e;var g=function(){var f=o(13),c=new f({xdomain:!1});return c.responseType!=null}();y(e,l),e.prototype.name="polling",e.prototype.doOpen=function(){this.poll()},e.prototype.pause=function(f){function c(){h.readyState="paused",f()}var h=this;if(this.readyState="pausing",this.polling||!this.writable){var a=0;this.polling&&(a++,this.once("pollComplete",function(){--a||c()})),this.writable||(a++,this.once("drain",function(){--a||c()}))}else c()},e.prototype.poll=function(){this.polling=!0,this.doPoll(),this.emit("poll")},e.prototype.onData=function(f){var c=this,h=function(a,r,u){return c.readyState==="opening"&&a.type==="open"&&c.onOpen(),a.type==="close"?(c.onClose(),!1):void c.onPacket(a)};d.decodePayload(f,this.socket.binaryType,h),this.readyState!=="closed"&&(this.polling=!1,this.emit("pollComplete"),this.readyState==="open"&&this.poll())},e.prototype.doClose=function(){function f(){c.write([{type:"close"}])}var c=this;this.readyState==="open"?f():this.once("open",f)},e.prototype.write=function(f){var c=this;this.writable=!1;var h=function(){c.writable=!0,c.emit("drain")};d.encodePayload(f,this.supportsBinary,function(a){c.doWrite(a,h)})},e.prototype.uri=function(){var f=this.query||{},c=this.secure?"https":"http",h="";this.timestampRequests!==!1&&(f[this.timestampParam]=b()),this.supportsBinary||f.sid||(f.b64=1),f=p.encode(f),this.port&&(c==="https"&&Number(this.port)!==443||c==="http"&&Number(this.port)!==80)&&(h=":"+this.port),f.length&&(f="?"+f);var a=this.hostname.indexOf(":")!==-1;return c+"://"+(a?"["+this.hostname+"]":this.hostname)+h+this.path+f}},function(n,s,o){function e(d){this.path=d.path,this.hostname=d.hostname,this.port=d.port,this.secure=d.secure,this.query=d.query,this.timestampParam=d.timestampParam,this.timestampRequests=d.timestampRequests,this.readyState="",this.agent=d.agent||!1,this.socket=d.socket,this.enablesXDR=d.enablesXDR,this.withCredentials=d.withCredentials,this.pfx=d.pfx,this.key=d.key,this.passphrase=d.passphrase,this.cert=d.cert,this.ca=d.ca,this.ciphers=d.ciphers,this.rejectUnauthorized=d.rejectUnauthorized,this.forceNode=d.forceNode,this.isReactNative=d.isReactNative,this.extraHeaders=d.extraHeaders,this.localAddress=d.localAddress}var l=o(19),p=o(5);n.exports=e,p(e.prototype),e.prototype.onError=function(d,y){var b=new Error(d);return b.type="TransportError",b.description=y,this.emit("error",b),this},e.prototype.open=function(){return this.readyState!=="closed"&&this.readyState!==""||(this.readyState="opening",this.doOpen()),this},e.prototype.close=function(){return this.readyState!=="opening"&&this.readyState!=="open"||(this.doClose(),this.onClose()),this},e.prototype.send=function(d){if(this.readyState!=="open")throw new Error("Transport not open");this.write(d)},e.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},e.prototype.onData=function(d){var y=l.decodePacket(d,this.socket.binaryType);this.onPacket(y)},e.prototype.onPacket=function(d){this.emit("packet",d)},e.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(n,s,o){function e(w,A){var S="b"+s.packets[w.type]+w.data.data;return A(S)}function l(w,A,S){if(!A)return s.encodeBase64Packet(w,S);var B=w.data,R=new Uint8Array(B),M=new Uint8Array(1+B.byteLength);M[0]=k[w.type];for(var N=0;N<R.length;N++)M[N+1]=R[N];return S(M.buffer)}function p(w,A,S){if(!A)return s.encodeBase64Packet(w,S);var B=new FileReader;return B.onload=function(){s.encodePacket({type:w.type,data:B.result},A,!0,S)},B.readAsArrayBuffer(w.data)}function d(w,A,S){if(!A)return s.encodeBase64Packet(w,S);if(m)return p(w,A,S);var B=new Uint8Array(1);B[0]=k[w.type];var R=new C([B.buffer,w.data]);return S(R)}function y(w){try{w=r.decode(w,{strict:!1})}catch{return!1}return w}function b(w,A,S){for(var B=new Array(w.length),R=a(w.length,S),M=function(I,T,j){A(T,function(O,D){B[I]=D,j(O,B)})},N=0;N<w.length;N++)M(N,w[N],R)}var g,f=o(20),c=o(21),h=o(22),a=o(23),r=o(24);typeof ArrayBuffer<"u"&&(g=o(25));var u=typeof navigator<"u"&&/Android/i.test(navigator.userAgent),v=typeof navigator<"u"&&/PhantomJS/i.test(navigator.userAgent),m=u||v;s.protocol=3;var k=s.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},x=f(k),E={type:"error",data:"parser error"},C=o(26);s.encodePacket=function(w,A,S,B){typeof A=="function"&&(B=A,A=!1),typeof S=="function"&&(B=S,S=null);var R=w.data===void 0?void 0:w.data.buffer||w.data;if(typeof ArrayBuffer<"u"&&R instanceof ArrayBuffer)return l(w,A,B);if(typeof C<"u"&&R instanceof C)return d(w,A,B);if(R&&R.base64)return e(w,B);var M=k[w.type];return w.data!==void 0&&(M+=S?r.encode(String(w.data),{strict:!1}):String(w.data)),B(""+M)},s.encodeBase64Packet=function(w,A){var S="b"+s.packets[w.type];if(typeof C<"u"&&w.data instanceof C){var B=new FileReader;return B.onload=function(){var T=B.result.split(",")[1];A(S+T)},B.readAsDataURL(w.data)}var R;try{R=String.fromCharCode.apply(null,new Uint8Array(w.data))}catch{for(var M=new Uint8Array(w.data),N=new Array(M.length),I=0;I<M.length;I++)N[I]=M[I];R=String.fromCharCode.apply(null,N)}return S+=btoa(R),A(S)},s.decodePacket=function(w,A,S){if(w===void 0)return E;if(typeof w=="string"){if(w.charAt(0)==="b")return s.decodeBase64Packet(w.substr(1),A);if(S&&(w=y(w),w===!1))return E;var R=w.charAt(0);return Number(R)==R&&x[R]?w.length>1?{type:x[R],data:w.substring(1)}:{type:x[R]}:E}var B=new Uint8Array(w),R=B[0],M=h(w,1);return C&&A==="blob"&&(M=new C([M])),{type:x[R],data:M}},s.decodeBase64Packet=function(w,A){var S=x[w.charAt(0)];if(!g)return{type:S,data:{base64:!0,data:w.substr(1)}};var B=g.decode(w.substr(1));return A==="blob"&&C&&(B=new C([B])),{type:S,data:B}},s.encodePayload=function(w,A,S){function B(N){return N.length+":"+N}function R(N,I){s.encodePacket(N,!!M&&A,!1,function(T){I(null,B(T))})}typeof A=="function"&&(S=A,A=null);var M=c(w);return A&&M?C&&!m?s.encodePayloadAsBlob(w,S):s.encodePayloadAsArrayBuffer(w,S):w.length?void b(w,R,function(N,I){return S(I.join(""))}):S("0:")},s.decodePayload=function(w,A,S){if(typeof w!="string")return s.decodePayloadAsBinary(w,A,S);typeof A=="function"&&(S=A,A=null);var B;if(w==="")return S(E,0,1);for(var R,M,N="",I=0,T=w.length;I<T;I++){var j=w.charAt(I);if(j===":"){if(N===""||N!=(R=Number(N))||(M=w.substr(I+1,R),N!=M.length))return S(E,0,1);if(M.length){if(B=s.decodePacket(M,A,!1),E.type===B.type&&E.data===B.data)return S(E,0,1);var O=S(B,I+R,T);if(O===!1)return}I+=R,N=""}else N+=j}return N!==""?S(E,0,1):void 0},s.encodePayloadAsArrayBuffer=function(w,A){function S(B,R){s.encodePacket(B,!0,!0,function(M){return R(null,M)})}return w.length?void b(w,S,function(B,R){var M=R.reduce(function(T,j){var O;return O=typeof j=="string"?j.length:j.byteLength,T+O.toString().length+O+2},0),N=new Uint8Array(M),I=0;return R.forEach(function(T){var j=typeof T=="string",O=T;if(j){for(var D=new Uint8Array(T.length),P=0;P<T.length;P++)D[P]=T.charCodeAt(P);O=D.buffer}j?N[I++]=0:N[I++]=1;for(var ut=O.byteLength.toString(),P=0;P<ut.length;P++)N[I++]=parseInt(ut[P]);N[I++]=255;for(var D=new Uint8Array(O),P=0;P<D.length;P++)N[I++]=D[P]}),A(N.buffer)}):A(new ArrayBuffer(0))},s.encodePayloadAsBlob=function(w,A){function S(B,R){s.encodePacket(B,!0,!0,function(M){var N=new Uint8Array(1);if(N[0]=1,typeof M=="string"){for(var I=new Uint8Array(M.length),T=0;T<M.length;T++)I[T]=M.charCodeAt(T);M=I.buffer,N[0]=0}for(var j=M instanceof ArrayBuffer?M.byteLength:M.size,O=j.toString(),D=new Uint8Array(O.length+1),T=0;T<O.length;T++)D[T]=parseInt(O[T]);if(D[O.length]=255,C){var P=new C([N.buffer,D.buffer,M]);R(null,P)}})}b(w,S,function(B,R){return A(new C(R))})},s.decodePayloadAsBinary=function(w,A,S){typeof A=="function"&&(S=A,A=null);for(var B=w,R=[];B.byteLength>0;){for(var M=new Uint8Array(B),N=M[0]===0,I="",T=1;M[T]!==255;T++){if(I.length>310)return S(E,0,1);I+=M[T]}B=h(B,2+I.length),I=parseInt(I);var j=h(B,0,I);if(N)try{j=String.fromCharCode.apply(null,new Uint8Array(j))}catch{var O=new Uint8Array(j);j="";for(var T=0;T<O.length;T++)j+=String.fromCharCode(O[T])}R.push(j),B=h(B,I)}var D=R.length;R.forEach(function(P,ut){S(s.decodePacket(P,A,!0),ut,D)})}},function(n,s){n.exports=Object.keys||function(o){var e=[],l=Object.prototype.hasOwnProperty;for(var p in o)l.call(o,p)&&e.push(p);return e}},function(n,s,o){function e(b){if(!b||typeof b!="object")return!1;if(l(b)){for(var g=0,f=b.length;g<f;g++)if(e(b[g]))return!0;return!1}if(typeof Buffer=="function"&&Buffer.isBuffer&&Buffer.isBuffer(b)||typeof ArrayBuffer=="function"&&b instanceof ArrayBuffer||d&&b instanceof Blob||y&&b instanceof File)return!0;if(b.toJSON&&typeof b.toJSON=="function"&&arguments.length===1)return e(b.toJSON(),!0);for(var c in b)if(Object.prototype.hasOwnProperty.call(b,c)&&e(b[c]))return!0;return!1}var l=o(7),p=Object.prototype.toString,d=typeof Blob=="function"||typeof Blob<"u"&&p.call(Blob)==="[object BlobConstructor]",y=typeof File=="function"||typeof File<"u"&&p.call(File)==="[object FileConstructor]";n.exports=e},function(n,s){n.exports=function(o,e,l){var p=o.byteLength;if(e=e||0,l=l||p,o.slice)return o.slice(e,l);if(e<0&&(e+=p),l<0&&(l+=p),l>p&&(l=p),e>=p||e>=l||p===0)return new ArrayBuffer(0);for(var d=new Uint8Array(o),y=new Uint8Array(l-e),b=e,g=0;b<l;b++,g++)y[g]=d[b];return y.buffer}},function(n,s){function o(l,p,d){function y(g,f){if(y.count<=0)throw new Error("after called too many times");--y.count,g?(b=!0,p(g),p=d):y.count!==0||b||p(null,f)}var b=!1;return d=d||e,y.count=l,l===0?p():y}function e(){}n.exports=o},function(n,s){function o(u){for(var v,m,k=[],x=0,E=u.length;x<E;)v=u.charCodeAt(x++),v>=55296&&v<=56319&&x<E?(m=u.charCodeAt(x++),(64512&m)==56320?k.push(((1023&v)<<10)+(1023&m)+65536):(k.push(v),x--)):k.push(v);return k}function e(u){for(var v,m=u.length,k=-1,x="";++k<m;)v=u[k],v>65535&&(v-=65536,x+=r(v>>>10&1023|55296),v=56320|1023&v),x+=r(v);return x}function l(u,v){if(u>=55296&&u<=57343){if(v)throw Error("Lone surrogate U+"+u.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function p(u,v){return r(u>>v&63|128)}function d(u,v){if((4294967168&u)==0)return r(u);var m="";return(4294965248&u)==0?m=r(u>>6&31|192):(4294901760&u)==0?(l(u,v)||(u=65533),m=r(u>>12&15|224),m+=p(u,6)):(4292870144&u)==0&&(m=r(u>>18&7|240),m+=p(u,12),m+=p(u,6)),m+=r(63&u|128)}function y(u,v){v=v||{};for(var m,k=v.strict!==!1,x=o(u),E=x.length,C=-1,w="";++C<E;)m=x[C],w+=d(m,k);return w}function b(){if(a>=h)throw Error("Invalid byte index");var u=255&c[a];if(a++,(192&u)==128)return 63&u;throw Error("Invalid continuation byte")}function g(u){var v,m,k,x,E;if(a>h)throw Error("Invalid byte index");if(a==h)return!1;if(v=255&c[a],a++,(128&v)==0)return v;if((224&v)==192){if(m=b(),E=(31&v)<<6|m,E>=128)return E;throw Error("Invalid continuation byte")}if((240&v)==224){if(m=b(),k=b(),E=(15&v)<<12|m<<6|k,E>=2048)return l(E,u)?E:65533;throw Error("Invalid continuation byte")}if((248&v)==240&&(m=b(),k=b(),x=b(),E=(7&v)<<18|m<<12|k<<6|x,E>=65536&&E<=1114111))return E;throw Error("Invalid UTF-8 detected")}function f(u,v){v=v||{};var m=v.strict!==!1;c=o(u),h=c.length,a=0;for(var k,x=[];(k=g(m))!==!1;)x.push(k);return e(x)}var c,h,a,r=String.fromCharCode;n.exports={version:"2.1.2",encode:y,decode:f}},function(n,s){(function(o){"use strict";s.encode=function(e){var l,p=new Uint8Array(e),d=p.length,y="";for(l=0;l<d;l+=3)y+=o[p[l]>>2],y+=o[(3&p[l])<<4|p[l+1]>>4],y+=o[(15&p[l+1])<<2|p[l+2]>>6],y+=o[63&p[l+2]];return d%3===2?y=y.substring(0,y.length-1)+"=":d%3===1&&(y=y.substring(0,y.length-2)+"=="),y},s.decode=function(e){var l,p,d,y,b,g=.75*e.length,f=e.length,c=0;e[e.length-1]==="="&&(g--,e[e.length-2]==="="&&g--);var h=new ArrayBuffer(g),a=new Uint8Array(h);for(l=0;l<f;l+=4)p=o.indexOf(e[l]),d=o.indexOf(e[l+1]),y=o.indexOf(e[l+2]),b=o.indexOf(e[l+3]),a[c++]=p<<2|d>>4,a[c++]=(15&d)<<4|y>>2,a[c++]=(3&y)<<6|63&b;return h}})("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},function(n,s){function o(g){return g.map(function(f){if(f.buffer instanceof ArrayBuffer){var c=f.buffer;if(f.byteLength!==c.byteLength){var h=new Uint8Array(f.byteLength);h.set(new Uint8Array(c,f.byteOffset,f.byteLength)),c=h.buffer}return c}return f})}function e(g,f){f=f||{};var c=new p;return o(g).forEach(function(h){c.append(h)}),f.type?c.getBlob(f.type):c.getBlob()}function l(g,f){return new Blob(o(g),f||{})}var p=typeof p<"u"?p:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"&&MozBlobBuilder,d=function(){try{var g=new Blob(["hi"]);return g.size===2}catch{return!1}}(),y=d&&function(){try{var g=new Blob([new Uint8Array([1,2])]);return g.size===2}catch{return!1}}(),b=p&&p.prototype.append&&p.prototype.getBlob;typeof Blob<"u"&&(e.prototype=Blob.prototype,l.prototype=Blob.prototype),n.exports=function(){return d?y?Blob:l:b?e:void 0}()},function(n,s){s.encode=function(o){var e="";for(var l in o)o.hasOwnProperty(l)&&(e.length&&(e+="&"),e+=encodeURIComponent(l)+"="+encodeURIComponent(o[l]));return e},s.decode=function(o){for(var e={},l=o.split("&"),p=0,d=l.length;p<d;p++){var y=l[p].split("=");e[decodeURIComponent(y[0])]=decodeURIComponent(y[1])}return e}},function(n,s){n.exports=function(o,e){var l=function(){};l.prototype=e.prototype,o.prototype=new l,o.prototype.constructor=o}},function(n,s){"use strict";function o(c){var h="";do h=d[c%y]+h,c=Math.floor(c/y);while(c>0);return h}function e(c){var h=0;for(f=0;f<c.length;f++)h=h*y+b[c.charAt(f)];return h}function l(){var c=o(+new Date);return c!==p?(g=0,p=c):c+"."+o(g++)}for(var p,d="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),y=64,b={},g=0,f=0;f<y;f++)b[d[f]]=f;l.encode=o,l.decode=e,n.exports=l},function(n,s,o){function e(){}function l(c){p.call(this,c),this.query=this.query||{},b||(b=y.___eio=y.___eio||[]),this.index=b.length;var h=this;b.push(function(a){h.onData(a)}),this.query.j=this.index,typeof addEventListener=="function"&&addEventListener("beforeunload",function(){h.script&&(h.script.onerror=e)},!1)}var p=o(17),d=o(28),y=o(15);n.exports=l;var b,g=/\n/g,f=/\\n/g;d(l,p),l.prototype.supportsBinary=!1,l.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),p.prototype.doClose.call(this)},l.prototype.doPoll=function(){var c=this,h=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),h.async=!0,h.src=this.uri(),h.onerror=function(u){c.onError("jsonp poll error",u)};var a=document.getElementsByTagName("script")[0];a?a.parentNode.insertBefore(h,a):(document.head||document.body).appendChild(h),this.script=h;var r=typeof navigator<"u"&&/gecko/i.test(navigator.userAgent);r&&setTimeout(function(){var u=document.createElement("iframe");document.body.appendChild(u),document.body.removeChild(u)},100)},l.prototype.doWrite=function(c,h){function a(){r(),h()}function r(){if(u.iframe)try{u.form.removeChild(u.iframe)}catch(C){u.onError("jsonp polling iframe removal error",C)}try{var E='<iframe src="javascript:0" name="'+u.iframeId+'">';v=document.createElement(E)}catch{v=document.createElement("iframe"),v.name=u.iframeId,v.src="javascript:0"}v.id=u.iframeId,u.form.appendChild(v),u.iframe=v}var u=this;if(!this.form){var v,m=document.createElement("form"),k=document.createElement("textarea"),x=this.iframeId="eio_iframe_"+this.index;m.className="socketio",m.style.position="absolute",m.style.top="-1000px",m.style.left="-1000px",m.target=x,m.method="POST",m.setAttribute("accept-charset","utf-8"),k.name="d",m.appendChild(k),document.body.appendChild(m),this.form=m,this.area=k}this.form.action=this.uri(),r(),c=c.replace(f,`\\
`),this.area.value=c.replace(g,"\\n");try{this.form.submit()}catch{}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){u.iframe.readyState==="complete"&&a()}:this.iframe.onload=a}},function(n,s,o){function e(h){var a=h&&h.forceBase64;a&&(this.supportsBinary=!1),this.perMessageDeflate=h.perMessageDeflate,this.usingBrowserWebSocket=l&&!h.forceNode,this.protocols=h.protocols,this.usingBrowserWebSocket||(c=p),d.call(this,h)}var l,p,d=o(18),y=o(19),b=o(27),g=o(28),f=o(29);if(o(3)("engine.io-client:websocket"),typeof WebSocket<"u"?l=WebSocket:typeof self<"u"&&(l=self.WebSocket||self.MozWebSocket),typeof window>"u")try{p=o(32)}catch{}var c=l||p;n.exports=e,g(e,d),e.prototype.name="websocket",e.prototype.supportsBinary=!0,e.prototype.doOpen=function(){if(this.check()){var h=this.uri(),a=this.protocols,r={};this.isReactNative||(r.agent=this.agent,r.perMessageDeflate=this.perMessageDeflate,r.pfx=this.pfx,r.key=this.key,r.passphrase=this.passphrase,r.cert=this.cert,r.ca=this.ca,r.ciphers=this.ciphers,r.rejectUnauthorized=this.rejectUnauthorized),this.extraHeaders&&(r.headers=this.extraHeaders),this.localAddress&&(r.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?a?new c(h,a):new c(h):new c(h,a,r)}catch(u){return this.emit("error",u)}this.ws.binaryType===void 0&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},e.prototype.addEventListeners=function(){var h=this;this.ws.onopen=function(){h.onOpen()},this.ws.onclose=function(){h.onClose()},this.ws.onmessage=function(a){h.onData(a.data)},this.ws.onerror=function(a){h.onError("websocket error",a)}},e.prototype.write=function(h){function a(){r.emit("flush"),setTimeout(function(){r.writable=!0,r.emit("drain")},0)}var r=this;this.writable=!1;for(var u=h.length,v=0,m=u;v<m;v++)(function(k){y.encodePacket(k,r.supportsBinary,function(x){if(!r.usingBrowserWebSocket){var E={};if(k.options&&(E.compress=k.options.compress),r.perMessageDeflate){var C=typeof x=="string"?Buffer.byteLength(x):x.length;C<r.perMessageDeflate.threshold&&(E.compress=!1)}}try{r.usingBrowserWebSocket?r.ws.send(x):r.ws.send(x,E)}catch{}--u||a()})})(h[v])},e.prototype.onClose=function(){d.prototype.onClose.call(this)},e.prototype.doClose=function(){typeof this.ws<"u"&&this.ws.close()},e.prototype.uri=function(){var h=this.query||{},a=this.secure?"wss":"ws",r="";this.port&&(a==="wss"&&Number(this.port)!==443||a==="ws"&&Number(this.port)!==80)&&(r=":"+this.port),this.timestampRequests&&(h[this.timestampParam]=f()),this.supportsBinary||(h.b64=1),h=b.encode(h),h.length&&(h="?"+h);var u=this.hostname.indexOf(":")!==-1;return a+"://"+(u?"["+this.hostname+"]":this.hostname)+r+this.path+h},e.prototype.check=function(){return!(!c||"__initialize"in c&&this.name===e.prototype.name)}},function(n,s){},function(n,s){var o=[].indexOf;n.exports=function(e,l){if(o)return e.indexOf(l);for(var p=0;p<e.length;++p)if(e[p]===l)return p;return-1}},function(n,s,o){"use strict";function e(r,u,v){this.io=r,this.nsp=u,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},v&&v.query&&(this.query=v.query),this.io.autoConnect&&this.open()}var l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},p=o(4),d=o(5),y=o(35),b=o(36),g=o(37),f=(o(3)("socket.io-client:socket"),o(27)),c=o(21);n.exports=s=e;var h={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},a=d.prototype.emit;d(e.prototype),e.prototype.subEvents=function(){if(!this.subs){var r=this.io;this.subs=[b(r,"open",g(this,"onopen")),b(r,"packet",g(this,"onpacket")),b(r,"close",g(this,"onclose"))]}},e.prototype.open=e.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.reconnecting||this.io.open(),this.io.readyState==="open"&&this.onopen(),this.emit("connecting"),this)},e.prototype.send=function(){var r=y(arguments);return r.unshift("message"),this.emit.apply(this,r),this},e.prototype.emit=function(r){if(h.hasOwnProperty(r))return a.apply(this,arguments),this;var u=y(arguments),v={type:(this.flags.binary!==void 0?this.flags.binary:c(u))?p.BINARY_EVENT:p.EVENT,data:u};return v.options={},v.options.compress=!this.flags||this.flags.compress!==!1,typeof u[u.length-1]=="function"&&(this.acks[this.ids]=u.pop(),v.id=this.ids++),this.connected?this.packet(v):this.sendBuffer.push(v),this.flags={},this},e.prototype.packet=function(r){r.nsp=this.nsp,this.io.packet(r)},e.prototype.onopen=function(){if(this.nsp!=="/")if(this.query){var r=l(this.query)==="object"?f.encode(this.query):this.query;this.packet({type:p.CONNECT,query:r})}else this.packet({type:p.CONNECT})},e.prototype.onclose=function(r){this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",r)},e.prototype.onpacket=function(r){var u=r.nsp===this.nsp,v=r.type===p.ERROR&&r.nsp==="/";if(u||v)switch(r.type){case p.CONNECT:this.onconnect();break;case p.EVENT:this.onevent(r);break;case p.BINARY_EVENT:this.onevent(r);break;case p.ACK:this.onack(r);break;case p.BINARY_ACK:this.onack(r);break;case p.DISCONNECT:this.ondisconnect();break;case p.ERROR:this.emit("error",r.data)}},e.prototype.onevent=function(r){var u=r.data||[];r.id!=null&&u.push(this.ack(r.id)),this.connected?a.apply(this,u):this.receiveBuffer.push(u)},e.prototype.ack=function(r){var u=this,v=!1;return function(){if(!v){v=!0;var m=y(arguments);u.packet({type:c(m)?p.BINARY_ACK:p.ACK,id:r,data:m})}}},e.prototype.onack=function(r){var u=this.acks[r.id];typeof u=="function"&&(u.apply(this,r.data),delete this.acks[r.id])},e.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emitBuffered(),this.emit("connect")},e.prototype.emitBuffered=function(){var r;for(r=0;r<this.receiveBuffer.length;r++)a.apply(this,this.receiveBuffer[r]);for(this.receiveBuffer=[],r=0;r<this.sendBuffer.length;r++)this.packet(this.sendBuffer[r]);this.sendBuffer=[]},e.prototype.ondisconnect=function(){this.destroy(),this.onclose("io server disconnect")},e.prototype.destroy=function(){if(this.subs){for(var r=0;r<this.subs.length;r++)this.subs[r].destroy();this.subs=null}this.io.destroy(this)},e.prototype.close=e.prototype.disconnect=function(){return this.connected&&this.packet({type:p.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},e.prototype.compress=function(r){return this.flags.compress=r,this},e.prototype.binary=function(r){return this.flags.binary=r,this}},function(n,s){function o(e,l){var p=[];l=l||0;for(var d=l||0;d<e.length;d++)p[d-l]=e[d];return p}n.exports=o},function(n,s){"use strict";function o(e,l,p){return e.on(l,p),{destroy:function(){e.removeListener(l,p)}}}n.exports=o},function(n,s){var o=[].slice;n.exports=function(e,l){if(typeof l=="string"&&(l=e[l]),typeof l!="function")throw new Error("bind() requires a function");var p=o.call(arguments,2);return function(){return l.apply(e,p.concat(o.call(arguments)))}}},function(n,s){function o(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}n.exports=o,o.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var l=Math.random(),p=Math.floor(l*this.jitter*e);e=(1&Math.floor(10*l))==0?e-p:e+p}return 0|Math.min(e,this.max)},o.prototype.reset=function(){this.attempts=0},o.prototype.setMin=function(e){this.ms=e},o.prototype.setMax=function(e){this.max=e},o.prototype.setJitter=function(e){this.jitter=e}}])})}),he="foo";function nt(t){return t&&t.Math===Math&&t}var U=nt(typeof globalThis=="object"&&globalThis)||nt(typeof window=="object"&&window)||nt(typeof self=="object"&&self)||nt(typeof global=="object"&&global)||function(){return this}()||Function("return this")(),Ct=U.top||U,z=U.parent||U,pe=U.opener||null,rt=class{constructor(t){this.handler=null,this.value=t}set(t){Object.is(this.value,t)||(this.value=t,this.apply())}get(){return this.value}on(t,i){let n=this.handler;for(;n!==null;)n.fn===t&&n.context===i&&console.warn("ReactiveValue#on: duplicate fn & context pair"),n=n.handler;this.handler={fn:t,context:i,handler:this.handler}}link(t,i){this.on(t,i),t.call(i,this.value)}off(t,i){let n=this.handler,s=this;for(;n!==null;){if(n.fn===t&&n.context===i){n.fn=function(){},s.handler=n.handler;return}s=n,n=n.handler}console.warn("ReactiveValue#off: fn & context pair not found, nothing was removed")}apply(){let t=this.handler;for(;t!==null;)t.fn.call(t.context,this.value),t=t.handler}};function Rt(t,i){let n=[...new Set(Array.isArray(i)?i:[])];return n.length!==t.length||n.some(s=>!t.includes(s))?n:t}var Z=class extends rt{constructor(t){super(Rt([],t))}set(t){super.set(Rt(this.value,t))}},Mt=class extends Z{constructor(){super([]),this.endpointLists=new Set}set(){super.set([].concat(...[...this.endpointLists].map(t=>t.value)))}add(t){this.endpointLists.has(t)||(this.endpointLists.add(t),t.on(this.set,this),this.set())}remove(t){this.endpointLists.has(t)&&(this.endpointLists.delete(t),t.off(this.set,this),this.set())}},Nt,ot=(Nt=U.trustedTypes)==null?void 0:Nt.emptyHTML;function J(t){function i(s){return Math.round(s).toString(36)}let n=i(10+25*Math.random());for(t||(t=16);n.length<t;)n+=i(Date.now()*Math.random());return n.substr(0,t)}function yt(t,i){return t.push(i),()=>{let n=t.indexOf(i);n!==-1&&t.splice(n,1)}}var It=!1,H="[rempl][event-transport] ",it=[],L=class{constructor(t,i,n){if(this.connections=new Map,this.connected=new rt(!1),this.endpointGetUI=new Map,this.ownEndpoints=new Z,this.remoteEndpoints=new Mt,this.initCallbacks=[],this.dataCallbacks=[],this.sendCallbacks=new Map,this.inited=!1,it.length===0&&typeof addEventListener=="function"&&addEventListener("message",s=>{for(let o of it)o._onMessage(s)},!1),it.push(this),this.name=t,this.connectTo=i,this.inputChannelId=`${t}/${J()}`,this.realm=n||U,this.ownEndpoints.on(s=>{this.connected.value&&this.send({type:"endpoints",data:[s]})}),typeof this.realm.postMessage!="function"||typeof addEventListener!="function"){console.warn(H+"Event (postMessage) transport isn't supported");return}this._handshake(!1)}static get(t,i,n){return n||(n=U),it.find(s=>s.name===t&&s.connectTo===i&&s.realm===n)||new L(t,i,n)}_handshake(t){this._send(`${this.connectTo}:connect`,{type:"handshake",initiator:this.name,inited:t,endpoints:this.ownEndpoints.value})}_onMessage(t){var i;if(t.source!==this.realm||t.target!==U)return;let n=t.data||{},s=`${this.name}:connect`;switch(n.to){case s:((i=n.payload)==null?void 0:i.initiator)===this.connectTo&&this._onConnect(n.from,n.payload);break;case this.inputChannelId:this.connections.has(n.from)?this._onData(n.from,n.payload):console.warn(H+"unknown incoming connection",n.from);break}}_onConnect(t,i){if(i.inited||this._handshake(!0),!this.connections.has(t)){let n=new Z(i.endpoints);this.remoteEndpoints.add(n),this.connections.set(t,{ttl:Date.now(),endpoints:n}),this._send(t,{type:"connect",endpoints:this.ownEndpoints.value})}this.inited=!0}_onData(t,i){var n,s,o;switch(It&&console.log(H+"receive from "+this.connectTo,i.type,i),i.type){case"connect":{(n=this.connections.get(t))==null||n.endpoints.set(i.endpoints),this.connected.set(!0),this.initCallbacks.splice(0).forEach(e=>this.onInit(...e));break}case"endpoints":{(s=this.connections.get(t))==null||s.endpoints.set(i.data[0]);break}case"disconnect":{(o=this.connections.get(t))==null||o.endpoints.set([]),this.connected.set(!1);break}case"callback":{if(i.callback){let e=this.sendCallbacks.get(i.callback);typeof e=="function"&&(e(...i.data),this.sendCallbacks.delete(i.callback))}break}case"data":{let e=i.data,l=i.callback;l&&(e=e.concat(this._wrapCallback(t,l)));for(let{endpoint:p,fn:d}of this.dataCallbacks)p===i.endpoint&&d(...e);break}case"getRemoteUI":{if(!i.endpoint)return;let e=this.endpointGetUI.get(i.endpoint);if(typeof e!="function")console.warn(H+"receive unknown endpoint for getRemoteUI(): "+i.endpoint),i.callback&&this._wrapCallback(t,i.callback)("Wrong endpoint \u2013 "+i.endpoint);else if(i.callback){let l=this._wrapCallback(t,i.callback);e(i.data[0]||{}).catch(p=>({error:String(p?.message)})).then(p=>{"error"in p?l(p.error):l(null,p.type,p.value)})}break}default:console.warn(H+"Unknown message type `"+i.type+"` for `"+this.name+"`",i)}}_wrapCallback(t,i){return(...n)=>this._send(t,{type:"callback",callback:i,data:n})}_send(t,i){if(It&&console.log(H+"emit event",t,i),typeof this.realm.postMessage=="function"){let n={from:this.inputChannelId,to:t,payload:i};this.realm.postMessage(n,"*")}}subscribeToEndpoint(t,i){return yt(this.dataCallbacks,{endpoint:t,fn:i})}sendToEndpoint(t,i,...n){let s=null;n.length&&typeof n[n.length-1]=="function"&&(s=J(),this.sendCallbacks.set(s,n.pop())),this.send({type:i,endpoint:t,data:n,callback:s})}send(t){for(let i of this.connections.keys())this._send(i,t)}onInit(t,i){let n=t.id||null;return n&&(this.ownEndpoints.set(this.ownEndpoints.value.concat(n)),typeof t.getRemoteUI=="function"&&this.endpointGetUI.set(n,t.getRemoteUI)),this.inited?i({connected:this.connected,subscribe:this.subscribeToEndpoint.bind(this,n),getRemoteUI:this.sendToEndpoint.bind(this,n,"getRemoteUI"),send:this.sendToEndpoint.bind(this,n,"data")}):this.initCallbacks.push([t,i]),this}sync(t){let i=J(8)+":"+this.connectTo;return this.onInit(t,n=>{n.subscribe(t.processInput.bind(t)),n.connected.link(s=>{t.setupChannel(i,n.send,this.remoteEndpoints,s)})}),this}},Q=class{constructor(t,i){this.methods=Object.create(null),this.remoteMethodWrappers=Object.create(null),this.remoteMethods=[],this.listeners=null,this.name=t,this.owner=i,this.methods=Object.create(null)}isMethodProvided(t){return t in this.methods}provide(t,i){if(typeof t=="string")typeof i=="function"&&(this.methods[t]=i,this.owner.scheduleProvidedMethodsUpdate());else{let n=t;for(let[s,o]of Object.entries(n))typeof o=="function"&&(this.methods[s]=o,this.owner.scheduleProvidedMethodsUpdate())}}revoke(t){Array.isArray(t)?t.forEach(this.revoke,this):this.isMethodProvided(t)&&(delete this.methods[t],this.owner.scheduleProvidedMethodsUpdate())}isRemoteMethodExists(t){return this.remoteMethods.includes(t)}callRemote(t,...i){let n=null;return i.length&&typeof i[i.length-1]=="function"&&(n=i.pop(),console.warn("[rempl] Using a callback for Namespace#callMethod() is deprecated, use returned promise value instead")),new Promise(s=>{let o={type:"call",ns:this.name,method:t,args:i};this.owner.send(o,(...e)=>{s(e[0]),n?.(...e)})})}getRemoteMethod(t){let i=this.remoteMethodWrappers[t];return typeof i!="function"&&(i=this.remoteMethodWrappers[t]=Object.assign((...n)=>i.available?this.callRemote(t,...n):Promise.reject(new Error(`[rempl] ${this.owner.getName()} ns("${this.name}") has no available remote method "${t}`)),{available:this.remoteMethods.indexOf(t)!==-1})),i}onRemoteMethodsChanged(t){let i={event:"remoteMethodsChanged",callback:t,listeners:this.listeners};return this.listeners=i,t([...this.remoteMethods]),()=>{let n=this.listeners,s=this;for(;n!==null;){if(n===i){s.listeners=n.listeners;break}s=n,n=n.listeners}}}static invoke(t,i,n,s){let o=!1;n=n.concat((...e)=>{o=!0,s(...e),console.warn("[rempl] Using a callback in provided methods has been deprecated, just return a value or promise instead")}),Promise.resolve(t.methods[i].apply(null,n)).then(e=>{o||s(e)})}static notifyRemoteMethodsChanged(t){let i=t.listeners;for(let n in t.remoteMethodWrappers)t.remoteMethodWrappers[n].available=t.remoteMethods.includes(n);for(;i!==null;)i.event==="remoteMethodsChanged"&&i.callback.call(null,[...t.remoteMethods]),i=i.listeners}},Tt=class{constructor(t){this.type="Endpoint",this.channels=[],this.connected=new rt(!1),this.remoteEndpoints=new Mt,this.id=t||null,this.namespaces=Object.create(null),this.remoteEndpoints.on(i=>{this.connected.set(i.includes(this.id||"*"))},this)}get namespaceClass(){return Q}getName(){return this.type+(this.id?"#"+this.id:"")}ns(t){let i=this.namespaces[t];return i||(i=Object.assign(new this.namespaceClass(t,this)),this.namespaces[t]=i),i}send(t,i=null){for(let{send:n}of this.channels)n(t,i)}requestRemoteApi(){this.send({type:"getProvidedMethods"},t=>{this.setRemoteApi(t)})}setRemoteApi(t){let i=[];t||(t={});for(let n in t)if(Array.isArray(t[n])){let s=this.ns(n),o=t[n].slice().sort();(s.remoteMethods.length!==o.length||s.remoteMethods.some(function(e,l){return e!==o[l]}))&&(s.remoteMethods=o,i.push(s))}for(let n in this.namespaces)if(Array.isArray(t[n])===!1){let s=this.namespaces[n];s.remoteMethods=[],i.push(s)}i.forEach(n=>Q.notifyRemoteMethodsChanged(n))}getProvidedApi(){let t=Object.create(null);for(let i in this.namespaces)t[i]=Object.keys(this.namespaces[i].methods).sort();return t}scheduleProvidedMethodsUpdate(){this.providedMethodsUpdateTimer||(this.providedMethodsUpdateTimer=setTimeout(()=>{this.providedMethodsUpdateTimer=null,this.send({type:"remoteMethods",methods:this.getProvidedApi()})},0))}processInput(t,i){switch(t.type){case"call":{let n=t,s=this.ns(n.ns||"*");if(!s.isMethodProvided(n.method))return console.warn(`[rempl][sync] ${this.getName()} (namespace: ${n.ns||"default"}) has no remote method:`,n.method);Q.invoke(s,n.method,n.args,i);break}case"remoteMethods":{let n=t;this.setRemoteApi(n.methods);break}case"getProvidedMethods":i(this.getProvidedApi());break;default:console.warn("[rempl][sync] "+this.getName()+"Unknown packet type:",t.type)}}setupChannel(t,i,n,s){if(s)this.channels.push({type:t,send:i}),this.remoteEndpoints.add(n);else for(let o=0;o<this.channels.length;o++)if(this.channels[o].type===t&&this.channels[o].send===i){this.remoteEndpoints.remove(n),this.channels.splice(o,1);break}}},le=class extends Q{constructor(t,i){super(t,i),this._lastData=null,this.provide("init",()=>this._lastData),this.publish=n=>{this._lastData=n,i.send({type:"data",ns:this.name,payload:n})}}},jt=class extends Tt{constructor(){super(...arguments),this.type="Publisher"}get namespaceClass(){return le}},st=new Map,ue=class extends Q{constructor(t,i){super(t,i),st.set(this,[])}subscribe(t){return this.callRemote("init").then(t),yt(st.get(this)||[],t)}},mt=class extends Tt{constructor(t){super(t),this.type="Subscriber",this.connected.on(i=>{if(i){this.requestRemoteApi();for(let n in this.namespaces){let s=this.namespaces[n],o=st.get(s)||[];o.length&&s.callRemote("init").then(e=>{for(let l of o)l(e)})}}else this.setRemoteApi()})}get namespaceClass(){return ue}processInput(t,i){switch(t.type){case"data":{let{ns:n,payload:s}=t,o=st.get(this.ns(n||"*"));o&&o.slice().forEach(e=>e(s));break}default:super.processInput(t,i)}}},Ot=new Map,de=class extends jt{linkWindow(t){L.get("rempl-env-publisher","rempl-env-subscriber",t).sync(this)}};function fe(t){let i=Ot.get(t);return i||(Ot.set(t,i=new mt(t)),L.get("rempl-env-subscriber","rempl-env-publisher",z).sync(i)),i}function ye(t){return new de(t)}function me(){addEventListener("message",function t(i){let{action:n,scripts:s}=i.data||{};if(n==="rempl-sandbox-init-scripts"&&s){removeEventListener("message",t);for(let[o,e]of Object.entries(s))Function(`${e}
//# sourceURL=${o}`)()}})}var Pt=new WeakMap;z!==U&&addEventListener("message",function(t){let i=t.data||{};t.source&&i.to==="rempl-env-publisher:connect"&&Pt.set(t.source,i)},!0);function Ut(t,i){function n(p){if(t.type==="script"&&p.postMessage({action:"rempl-sandbox-init-scripts",scripts:t.content},"*"),z!==U&&p!==U){let d=NaN,y=NaN;if(o&&(removeEventListener("message",o,!0),o=null),addEventListener("message",o=function(b){let g=b.data||{};switch(g.to){case"rempl-env-subscriber:connect":case d:y=g.from,p.postMessage(g,"*");break;case"rempl-env-publisher:connect":case y:d=g.from,z.postMessage(g);break}},!0),t.type!=="script"){let b=Pt.get(p);b&&(d=b.from,z.postMessage(b))}}e=L.get("rempl-sandbox","rempl-subscriber",p).onInit({},d=>i(d)),l&&e.ownEndpoints.set(["*"])}let s=null,o=null,e=null,l=!1;return t=t||{},t.window?n(t.window):(s=document.createElement("iframe"),s.name=J(),s.onload=()=>s?.contentWindow&&n(s.contentWindow),s.setAttribute("sandbox","allow-scripts allow-forms allow-popups allow-modals"),t.type==="url"?s.src=t.content:t.sandboxSrc?s.src=t.sandboxSrc:s.srcdoc="<!doctype html><script>("+String(me)+")()<\/script>",(t.container||document.documentElement).appendChild(s)),{setConnected(p){l=p,e&&e.ownEndpoints.set(l?["*"]:[])},destroy(){o&&(removeEventListener("message",o,!0),o=null),e&&e.ownEndpoints.set([]),s!==null&&(s.remove(),s.setAttribute("srcdoc",ot),s.setAttribute("src",ot),s=null)}}}function Dt(t){function i(s){var o;let e=document.createElement(s.tagName||"div");for(let[l,p]of Object.entries(s))switch(l){case"tagName":break;case"ref":typeof p=="string"&&(n[p]=e);break;case"style":e.setAttribute("style",Object.entries(p).map(([d,y])=>d+":"+y).join(";"));break;case"events":for(let d in s.events)e.addEventListener(d,s.events[d],!1);break;case"children":(o=s.children)==null||o.forEach(function(d){e.appendChild(typeof d=="string"?document.createTextNode(d):i(d))});break;default:e.setAttribute(l,p)}return e}let n={};return n.element=i(t),n}var be=`:host{position:fixed;z-index:100000;inset:0;background:rgba(255,255,255,.8);backdrop-filter:blur(8px);opacity:1;font-family:Tahoma,Verdana,Arial,sans-serif;font-size:12px;transition:all cubic-bezier(.25,.59,0,1.11) .2s;border:0 solid #aaa}@supports not (backdrop-filter: blur(8px)){:host{background:rgba(255,255,255,.95)}}:host([side="left"]){right:50%;border-right-width:2px}:host([side="right"]){left:50%;border-left-width:2px}:host([side="top"]){bottom:50%;border-bottom-width:2px}:host([side="bottom"]){top:50%;border-top-width:2px}.host{display:flex;flex-direction:column;height:100%}.toolbar{display:flex;padding:0 0 0 24px;background:#f8f8f8 no-repeat 4px center / 16px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA3ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NTc3MiwgMjAxNC8wMS8xMy0xOTo0NDowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo2YTJlMWRlYi1kYzVhLTFiNDEtYTQ2OC0xYmU4ZjEyYzdkMzEiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NkNGQUMzNTZCQkM4MTFFNjg1QjhENzFGM0IzRkMzNjQiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NkNGQUMzNTVCQkM4MTFFNjg1QjhENzFGM0IzRkMzNjQiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTQgKFdpbmRvd3MpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MmE1NDdhODktNWJjOC05MzQ2LWI2NTctYzAwMGQ4ZjQxOTg4IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjZhMmUxZGViLWRjNWEtMWI0MS1hNDY4LTFiZThmMTJjN2QzMSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pn3Ab4gAAAPQSURBVHjatFfNSxtBFH+JiZootWojFBUqmtioiZUWbLUt1YOI9A9QaIsWSw/1mIMInryqN8EiVKVCKx48VFA8SLUeqlSUxI+qaGyhBy1RbNQkxmT7Zt1Ns7uzcTfaBz8Sdmbe783M+xrNGqgSG+Ixwo64h8jgvu8jviGciBmES6lCjQIDEhCvES8RdxXqXUC8Q7xFhGJN1F6gqB6xiehRQQ7c3B5ubX28BvQjPiDyIH7J43T0qzGAHPkXRCNcnTRyOhPEAzrK5FnEfbUMSampYCwpAYPNBklFRZBYXg6BmRnYaW3lpzzkdD+I5YTvEc9iEel0OjAWFoLBaoVkux30SJpgsYAmPx8gOVkwl1ldhfXiYrGKIcRz2gk8FZMbs7PZXRGiJCRMQGiRDDIylIUYrtdotcCEw9GfCccwYkx8AiSW08mfgsFB0FVVAeTmXvryf1kKwbu5If58wOcQ3glf8eTssVRUUMkDTid812io2O/qguD2tmSNwW6j2ZXOcUYMcESP+kdHVe90z+GALfQDsRHJNpvcEgdvgBVhEex0eflCwtsME8Gt2VnQo2MS8XR3C+Ylog/JCOG0EgNqxCM+BQYIdllZCTcc54cYWBPGFXHcGFJDDCgTfz1yYS3x+1UZETo8PPcfk0kYCWYz6BOT5JaVabnKJpCzYBCYjQ3F5McTE6wPELneKEqgej2k3imVW2oneSCTNnKGR6m322VJieeLJXd8HFJqa6WRgI54MD9PU5MpW4yCKvzAUF0N+VtbVHLWEaXZUFCMPLQBv8ulKApu9vWBb2oKftbVUfMAewvyBni0XBcjkROnU9Hu05qbIbO9HYLr67DX1kbvaLA4yYiTGLBINWBnB5PzviIj0lta2F/v8DD8GRmRTsjJAYMpi7Z0kRgwSRsJ4/GGsZopEV1WFnsVRH7jaTDHx5I5xlKqQ08SA0jmoMbcmUIDiFxraGCzIbmKg95eqaNKMyLhXOOjoJOmNKAiEjQpKWDq6IjUBbFDGuslrWGnbDmOBCmWZBN6+GWE2d1lk1pgehp+4PWIy3F0Q/IC8UmQ4ZaWwKSUyesFZnMTQkh2iiFMwvgEr/DY7RY3JDyXpCMa49qlSFfkP0BDj44AsN/75xhnwKDSMBKRZBVYWQEfIXItQ/A0oMTUIb4bojWlpFcriG5KT7E70qSlgX9uDnxkV0jq93jivZGv0f2g3MuItM6fuS72KoV0xE/ELyVaLSATHiEGrpB8gNMZUvMyakI0INyXIHZzOprifRt+RJgRb7gHp1JZ4NaYOR2Xeh3/1+f5XwEGANZLOnq2peEfAAAAAElFTkSuQmCC);border-bottom:1px solid #ddd;white-space:nowrap}.tab{display:inline-block;padding:5px 10px;color:#666;line-height:1;cursor:pointer;border-bottom:1px solid transparent}.tab:hover{background:#eee}.tab_selected{color:#444;border-bottom:2px solid rgba(62,130,247,.6);margin-bottom:-1px}.layout-buttons{display:flex}.layout-button{display:flex;align-items:center;justify-content:center;flex:0 0 auto;width:28px;height:24px;color:#646464;cursor:pointer}.layout-button:hover{background:rgb(66,128,236);color:#fff}.layout-button:before{content:"";width:15px;height:13px;border:2px solid currentColor;box-sizing:border-box}:host([side="left"]) .layout-button[side=left],:host([side="right"]) .layout-button[side=right],:host([side="top"]) .layout-button[side=top],:host([side="bottom"]) .layout-button[side=bottom],:host([side="fit the page"]) .layout-button[side="fit the page"]{color:#4280ec;background:none;cursor:default}.layout-button[side=external]:before{height:10px;width:13px;border-width:0 0 2px 2px;margin-bottom:-3px}.layout-button[side=external]:after{content:"";height:10px;width:13px;border:2px solid currentColor;box-sizing:border-box;margin-top:-3px;margin-left:-10px}.layout-button[side=top]:before{border-top-width:5px}.layout-button[side=right]:before{border-right-width:5px}.layout-button[side=bottom]:before{border-bottom-width:5px}.layout-button[side=left]:before{border-left-width:5px}.close-button{position:relative;width:28px;text-align:center;font:20px Arial,sans-serif;color:#5a5a5a;cursor:pointer}.close-button:hover{color:#000}.close-button:after{content:"\\d7";line-height:24px}.sandbox{flex:1 1 auto;position:relative}iframe{position:absolute;top:0;left:0;width:100%;height:100%;border:0;background:transparent}
`,Lt=[],bt=null,qt=()=>{},at=null,gt,ct={};function ge(t,i){ct[t]=i;try{localStorage.rempl=JSON.stringify(ct)}catch{}}function _t(t){t.classList.toggle("tab_selected",t.getAttribute("publisher")===bt)}function Wt(){let{tabs:t}=F();t.innerHTML=ot;for(let i of Lt){let{element:n}=Dt({publisher:i,class:"tab",children:[i],events:{click(){qt(i)}}});_t(n),t.appendChild(n)}}function F(){if(at===null){let t=document.createElement("div"),i=t.attachShadow({mode:"open"}),n=document.createElement("style"),s=Dt({class:"host",children:[{class:"toolbar",children:[{ref:"tabs",style:{display:"flex",flex:"1"}},{ref:"buttons",class:"layout-buttons",children:[...["left","top","bottom","right","fit the page"].map(o=>({side:o,title:`Dock to ${o}`,class:"layout-button",events:{click(){t.setAttribute("side",o),ge("host-dock",o)}}})),{class:"close-button",events:{click(){gt?.()}}}]}]},{ref:"sandbox",class:"sandbox"}]});try{Object.assign(ct,JSON.parse(localStorage.rempl||"{}"))}catch{}t.setAttribute("side",ct["host-dock"]||"bottom"),n.append(document.createTextNode(be)),i.append(n),i.append(s.element),at=ft({wrapper:t},s),Wt()}return at}function ve(t){let{wrapper:i}=F();gt=t,i.style.display="",document.contains(i)||(document.body||document.documentElement).append(i)}function we(){F().wrapper.style.display="none"}function ke(){F().wrapper.remove()}var W={show:ve,hide:ke,softHide:we,getSandboxContainer(){return F().sandbox},setPublisherList(t,i){Lt=t,qt=i,Wt()},selectPublisher(t){bt!==t&&(bt=t,at&&Array.from(F().tabs.children).forEach(i=>_t(i)))}},K=[],_=null,ht=!1,vt,wt=null,$=null,tt=null;function zt(){$!==null&&($.destroy(),$=null)}function pt(t=null){t||(t=null),t!==_&&(ht=!1,_=t,_?(W.selectPublisher(_),W.show(tt.deactivate),wt.onInit({id:_},function(i){i.getRemoteUI((n,s,o)=>{let e=W.getSandboxContainer();if(zt(),n){let l=document.createElement("div");l.append("Error on loading UI: ",n),l.setAttribute("style","margin:10px;padding:5px 10px;border-radius:3px;border:1px solid #eba8a8;color:#f34040;background:#ffe0e0;"),e.innerHTML=ot,e.append(l)}else $=Ut({container:e,type:s,content:o},l=>{i.subscribe(l.send),l.subscribe(i.send)}),$.setConnected(!0)})})):(W.hide(),zt()))}function xe(){return tt!==null?tt:(wt=L.get("rempl-inpage-host","rempl-inpage-publisher"),wt.remoteEndpoints.on(t=>{K=t,W.setPublisherList(K,pt),ht&&!_&&K.length&&pt(K[0])}),tt={activate(t){let i=typeof t=="string"?t:t?.id||_||K[0]||null;clearTimeout(vt),pt(i),W.show(tt.deactivate),_||(ht=!0)},deactivate(t){let i=typeof t=="string"?t:t?.id||null;ht=!1,(!i||i===_)&&(W.softHide(),clearTimeout(vt),vt=setTimeout(()=>pt(),15e3))}})}var Ae=class extends jt{constructor(t,i,n){super(t),this.options=n||{},this.getRemoteUI=s=>{try{return Promise.resolve(i(s)).then(o=>o.type==="script"?{type:"script",value:{"publisher-ui.js":o.value}}:o)}catch(o){return Promise.reject(o)}}}},kt=new Map,et=null;function Ee(t,i,n){let s=kt.get(t);return s?(console.warn(`[rempl] Publisher with ID "${t}" has been already created`),s):(s=new Ae(t,i,n),kt.set(t,s),et&&et.sync(s),s)}function Se(t,i){switch(i){case"implicit":case void 0:return t.explicit||t.implicit;case"explicit":return t.explicit}return i}function Ht(t,i,n,s){if(et===null)if(s=t?n().explicit:Se(n(),s),typeof s=="string"){et=i(s);for(let o of kt.values())et.sync(o)}else t||console.warn("[rempl] Connection to WS server doesn't established since bad value for URI",s);else console.warn("[rempl] Connection to WS server already set")}var Be=ae(ce(),1),xt=Object.create(null),Ce=100,G=!1,Y="[rempl][ws-transport] ";function Ft(t,i){for(let n of Object.keys(t)){let s=t[n],o=i[n];if(Array.isArray(s)){if(Ft(s,o))return!0}else if(String(s)!==String(o))return!0}return!1}function Gt(t){return t=String(t),/^\d+$/.test(t)?"ws://localhost:"+t:t.replace(/^http:\/\//i,"ws://").replace(/^https:\/\//i,"wss://").replace(/^([a-z]+:\/\/)|^/i,function(i,n){return n=n?n.toLowerCase():"",n==="ws://"||n==="wss://"?n:"ws://"})}function Re(t,i){return yt(this.dataCallbacks,{endpoint:t,fn:i})}function Me(t,i){this.send("rempl:from publisher",t,i)}function Ne(){clearInterval(this.sendInfoTimer),this.connected.set(!0),this.info=this.getInfo(),this.send("rempl:endpoint connect",this.info,t=>{"id"in t&&this.setClientId(t.id),this.sendInfoTimer=setInterval(this.sendInfo.bind(this),Ce)}),G&&console.log(Y+"connected")}function Ie(t,i,n){let s=this.publishersMap.get(t);if(!s){G&&console.error(Y+"Publisher `"+t+"` isn't registered"),n("Publisher `"+t+"` isn't registered");return}return s.getRemoteUI(i||{}).catch(o=>({error:String(o?.message)})).then(o=>{"error"in o?n(o.error):n(null,o.type,o.value)})}function Te(t,...i){if(!this.publishersMap.has(t)){G&&console.error(Y+"Publisher `"+t+"` isn't registered");return}this.dataCallbacks.forEach(function(n){n.endpoint===t&&n.fn.apply(null,i)})}function je(){G&&console.log(Y+"disconnected"),clearInterval(this.sendInfoTimer),this.connected.set(!1)}var Oe=class{constructor(t,i){this.publishers=[],this.publishersMap=new Map,this.dataCallbacks=[],this.connected=new rt(!1),this.ownEndpoints=new Z,this.remoteEndpoints=new Z,this.sessionId=J(),this.id=null,this.sendInfoTimer=null,this.info=this.getInfo(),G&&console.log(Y+"connecting to "+Gt(t)),this.socket=i.connect(Gt(t),{transports:["websocket"]}).on("connect",Ne.bind(this)).on("disconnect",je.bind(this)).on("rempl:get ui",Ie.bind(this)).on("rempl:to publisher",Te.bind(this))}static get(t,i){return t in xt?xt[t]:xt[t]=new this(t,i)}get type(){return"unknown"}setClientId(t){this.id=t}send(t,i,n){this.socket.emit(t,i,n)}getInfo(){return{id:this.id,sessionId:this.sessionId,type:this.type,publishers:[...this.publishers]}}sendInfo(){let t=this.getInfo();Ft(this.info,t)&&(this.info=t,this.send("rempl:endpoint info",this.info))}createApi(t){if(this.publishersMap.has(t.id)){G&&console.error(Y+"Publisher `"+t.id+"` is already registered");return}return t.id&&(this.publishers.push(t.id),this.publishersMap.set(t.id,{getRemoteUI:t.getRemoteUI})),this.sendInfo(),{connected:this.connected,send:Me.bind(this,t.id),subscribe:Re.bind(this,t.id)}}sync(t){let i=this.createApi(t);i&&(i.subscribe(t.processInput.bind(t)),i.connected.link(n=>{t.setupChannel("ws",i.send,this.remoteEndpoints,n)}))}},Pe=`:host{position:fixed;overflow:auto;inset:0;z-index:100000000;background:rgba(255,255,255,.9);text-align:center;line-height:1.5;font-family:Tahoma,Verdana,Arial,sans-serif}h1{font-size:100px;font-size:33vh;font-size:clamp(20px,33vh,100px);font-weight:400;margin:0}button{font-size:18px;line-height:1;padding:12px 24px;background:#3bafda;color:#fff;border:none;border-radius:3px;cursor:pointer}
`,lt="rempl-identify-widget",V=null;function Ue(t,i){let n=document.createElement("div"),s=n.attachShadow({mode:"closed"}),o=document.createElement("style"),e=document.createElement("div"),l=document.createElement("h1");return n.id=lt,n.dataset.origin=t,l.textContent=i,o.textContent=Pe,s.append(o,l,e),{overlayEl:n,createButton(p,d){let y=e.appendChild(document.createElement("div")),b=y.appendChild(document.createElement("button"));y.setAttribute("style","margin-bottom:5px"),b.textContent=p,b.addEventListener("click",d)}}}function De(t){postMessage(ft({to:lt},t))}function Le(t,i,n){if(typeof document>"u")return;let s=document.querySelector("#"+lt);if(!s||s.dataset.origin!==t){s&&postMessage({op:"stop-identify"});let{overlayEl:o,createButton:e}=Ue(t,String(i)),l=document.body.style.overflow;document.body.style.overflow="hidden",document.body.appendChild(o);let p=d=>{let{data:y}=d;if(y?.to===lt)switch(y.op){case"add-publisher":e(y.name||y.id,()=>n(y.id));break;case"stop-identify":console.log("stop-indentify"),V?.();break}};addEventListener("message",p),V=()=>{removeEventListener("message",p),document.body.style.overflow=l,o.remove(),V=null}}}function Yt(){typeof V=="function"&&V()}var Vt="rempl:id";function Xt(){function t(){if(typeof REMPL_SERVER<"u"&&REMPL_SERVER!==U.REMPL_SERVER)return REMPL_SERVER}function i(){let e=typeof document<"u"?document.querySelector('meta[name="rempl:server"]'):void 0;return e&&e.getAttribute("content")||void 0}let n=location.protocol+"//"+(location.hostname||"localhost")+":8177",s,o=t();switch(o===void 0&&(o=i()),o){case"none":case void 0:case!1:break;case"implicit":case"auto":case!0:s=n;break;default:typeof o=="string"&&(s=o)}return{explicit:s,implicit:n}}var qe=class extends Oe{constructor(t){super(t,Be.default);let i=this;try{this.id=sessionStorage[Vt]}catch{}this.socket.on("rempl:identify",function(n,s){Le(this.io.uri,n,s);for(let o of i.publishers)De({op:"add-publisher",id:o,name:o})}).on("rempl:stop identify",Yt).on("disconnect",Yt)}get type(){return"browser"}setClientId(t){super.setClientId(t);try{sessionStorage[Vt]=this.id}catch{}}getInfo(){var t,i,n,s;return oe(ft({},super.getInfo()),{location:String(location),title:((i=(t=Ct)==null?void 0:t.document)==null?void 0:i.title)||((s=(n=Ct)==null?void 0:n.location)==null?void 0:s.href)||"Unknown"})}};function Zt(t){return new qe(t)}function _e(t,i,n){Ht(!0,Zt,Xt);let s=Ee(t,i,n);return L.get("rempl-browser-extension-publisher","rempl-browser-extension-host").sync(s),L.get("rempl-inpage-publisher","rempl-inpage-host").sync(s),L.get("rempl-self-publisher","rempl-self-subscriber").sync(s),Object.assign(s.ns("*"),{ns:s.ns.bind(s)})}function We(t){Ht(!1,Zt,Xt,t)}var ze=`@keyframes fade-in{0%{opacity:0}50%{opacity:0;backdrop-filter:blur(0) grayscale(0)}to{opacity:1}}@keyframes dot-blink{50%{opacity:1}}:host{position:fixed;z-index:10000000;inset:0;text-align:center;font:12px arial;transition:opacity .5s;background:#fffe;animation-name:fade-in;animation-duration:1s;animation-iteration-count:1;animation-direction:normal}@supports (backdrop-filter: blur(1px)){:host{background:#fff8;backdrop-filter:blur(5px) grayscale(.8)}}:host:before{content:"Publisher connection is lost";margin:30px 0 5px;display:inline-block;padding:4px}.dot{background-color:#5096fa;display:inline-block;vertical-align:middle;height:6px;width:6px;margin:3px;opacity:0;animation-name:dot-blink;animation-duration:.65s;animation-iteration-count:infinite;animation-direction:normal;border-radius:50%}.dot:nth-child(1){animation-delay:.1s}.dot:nth-child(2){animation-delay:.175s}.dot:nth-child(3){animation-delay:.25s}
`,X=null;function He(){if(X===null){X=document.createElement("div");let t=X.attachShadow({mode:"closed"}),i=document.createElement("style"),n=document.createElement("div");i.textContent=ze,n.append(...Array.from({length:3},()=>{let s=document.createElement("div");return s.className="dot",s})),t.append(i,n)}return X}function Jt(t){t&&typeof document<"u"?document.body.append(He()):X&&X.remove()}var q=null;function Fe(){q=new mt;let t=Object.assign(q.connected,{defaultOverlay:!0});return t.link(i=>{i?Jt(!1):t.defaultOverlay&&Jt(!0)}),L.get("rempl-subscriber","rempl-sandbox",pe||z).sync(q),q}function Ge(){return q===null&&(q=Fe()),Object.assign(q.ns("*"),{connected:q.connected,ns:q.ns.bind(q)})}function Ye(t){let i=new mt(t);return L.get("rempl-self-subscriber","rempl-self-publisher").sync(i),Object.assign(i.ns("*"),{connected:i.connected,ns:i.ns.bind(i)})}function Ve(t,i=!1){let n=null;return function(s){return!s.dev&&n!==null?{type:"script",value:n}:fetch(t).then(o=>{if(!o.ok)throw new Error(`HTTP error! File "${t}", status: ${o.status}`);return o.text()}).then(o=>({type:"script",value:n=(i&&typeof At=="function"?"var rempl = ("+At.toString()+")();":"")+o}))}}return{connectPublisherWs:We,createEnv:ye,createPublisher:_e,createSandbox:Ut,getEnv:fe,getHost:xe,getSelfSubscriber:Ye,getSubscriber:Ge,scriptFromFile:Ve,version:he}}();export{Xe as connectPublisherWs,Ze as createEnv,Je as createPublisher,Qe as createSandbox,Ke as getEnv,$e as getHost,tn as getSelfSubscriber,en as getSubscriber,nn as scriptFromFile,rn as version};
